<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{common/layouts/default}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />
    <link rel="stylesheet" th:href="@{/css/report/brandGraph.css}"/>
    <link rel="stylesheet" th:href="@{/css/report/global_report.css}"/>
    <link rel="stylesheet" th:href="@{/css/logout.css}"/>
    <link rel="stylesheet" th:href="@{/global_main.css}"/>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@600&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto Sans KR:wght@400&display=swap"
    />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  </head>
  <body>
    <div class="div4">
      <div class="rectangle-parent1">
        <div class="group-child1"></div>
        <b class="ssgnack2">
          <a href="/main" style="text-decoration-line: none; color: black">SSGNACK</a>
        </b>
        <b class="admin2">Admin님 접속을 환영합니다.</b>
        <div class="group-child2">
          <div class="chart-container">
            <canvas id="brandChart"></canvas>
          </div>
        </div>
        <b class="b4">브랜드별 매출 보고</b>
      </div>
      <div class="item">
        <div class="moveother">
          <a th:href="@{/report/productGraph}" style="text-decoration-line:none; color: white; font-weight: 500; font-size: 20px">
            제품별 매출 |
          </a>
          <a th:href="@{/report/monthlyGraph}" style="text-decoration-line:none; color: white; font-weight: 500; font-size: 20px">
            기간별 매출
          </a>
        </div>
      </div>
      <div class="rectangle-parent2 logout">
        <div class="group-child3"></div>
        <a class="b5" th:href="@{../admin/login}" id="loginButton">로그아웃</a>
      </div>
      <div class="div5">
        <div class="form1">
          <div class="background1">
            <div class="container4">
              <div class="button-1">
                <img class="img-icon1" alt="" src="../public/img.svg" />
              </div>
            </div>
            <div class="input-1">
              <div class="container5">
                <div class="div6"></div>
              </div>
              <div class="container6">
                <div class="container7">
                    <input type="text" name="companyName" id="companyName" style="width: 90%">
                </div>
                <button type="button" id="btnBrand">검색</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="navigation-drawer-frame">
        <div class="navigation-drawer2">
          <div class="top-frame">
            <div class="top2">
              <div class="frame-container">
                <div class="vector-container">
                  <img class="vector-icon2" alt="" src="../public/vector.svg" />

                  <div class="menu2" id="mainButton">
                    <a href="/main" style="text-decoration-line: none; color: white">MENU</a>
                  </div>
                </div>
                <div class="productmanage2">
                  <div class="component-2variant310">
                    <div class="nav-item10">
                      <div class="productmanage2">
                        <div class="left10">
                          <img
                            class="administration-1-icon2"
                            alt=""
                            src="../public/administration-1@2x.png"
                          />

                          <div class="promotion12">
                            <a th:href="@{/stock/list}" style="text-decoration-line:none; color: white"> 재고 관리 </a>
                          </div>
                        </div>
                      </div>
                      <img
                        class="arrow-chevron-down-icon10"
                        alt=""
                        src="../public/arrowchevrondown.svg"
                      />
                    </div>
                  </div>
                </div>
                <div class="productmanage2">
                  <div class="component-2variant310">
                    <div class="nav-item10">
                      <div class="productmanage2">
                        <div class="left10">
                          <img
                            class="administration-1-icon2"
                            alt=""
                            src="../public/promotion-1@2x.png"
                          />

                          <div class="promotion12">
                            <a href="/product/main" class="promotion" style="text-decoration-line: none; color: white">제품 관리</a>
                          </div>
                        </div>
                      </div>
                      <img
                        class="arrow-chevron-down-icon10"
                        alt=""
                        src="../public/arrowchevrondown.svg"
                      />
                    </div>
                  </div>
                </div>
                <div class="productmanage2">
                  <div class="component-2variant310">
                    <div class="nav-item10">
                      <div class="productmanage2">
                        <div class="left10">
                          <img
                            class="administration-1-icon2"
                            alt=""
                            src="../public/customerloyalty-1@2x.png"
                          />

                          <div class="promotion12">
                            <a href="/stock/inbound" style="text-decoration-line: none; color: white">입고</a>
                          </div>
                        </div>
                      </div>
                      <img
                        class="arrow-chevron-down-icon10"
                        alt=""
                        src="../public/arrowchevrondown.svg"
                      />
                    </div>
                  </div>
                </div>
                <div class="productmanage2">
                  <div class="component-2variant310">
                    <div class="nav-item10">
                      <div class="productmanage2">
                        <div class="left10">
                          <img
                            class="administration-1-icon2"
                            alt=""
                            src="../public/productmanagement-1@2x.png"
                          />

                          <div class="promotion12">출고</div>
                        </div>
                      </div>
                      <img
                        class="arrow-chevron-down-icon10"
                        alt=""
                        src="../public/arrowchevrondown.svg"
                      />
                    </div>
                  </div>
                </div>
                <div class="orders4">
                  <div class="ordersvariant12">
                    <div class="productmanage2">
                      <div class="component-2variant310">
                        <div class="nav-item10">
                          <div class="productmanage2">
                            <div class="left10">
                              <img
                                class="administration-1-icon2"
                                alt=""
                                src="../public/order-2@2x.png"
                              />

                              <div class="promotion12">Orders</div>
                            </div>
                          </div>
                          <img
                            class="arrow-chevron-down-icon10"
                            alt=""
                            src="../public/arrowchevrondown.svg"
                          />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Chart.js 스크립트 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 바 형태의 그래프 스크립트 -->
    <script th:inline="javascript">

     $("#btnBrand").click(function () {
       const companyName = $("#companyName").val();
       console.log(companyName);
       $.ajax({
         url: "/brandSales",
         type: "get",
         data: {companyName},
         success: function (data) {
           console.log(data);

           var ctx = document.getElementById("brandChart").getContext("2d");

           var barChart = new Chart(ctx, {
             type: "bar",
             data: {
               labels: data.productName,
               datasets: [
                 {
                   label: "매출(단위:원)",
                   data: data.totalSale,
                   backgroundColor: [
                     "rgba(54, 162, 235, 1)",
                   ],
                   borderColor: [
                     "rgba(54, 162, 235, 1)",
                   ],
                   borderWidth: 1,
                 },
                 {
                   label: "순이익(단위:원)",
                   data: data.totalIncome,
                   backgroundColor: [
                     "rgba(255, 159, 64, 1)",
                   ],
                   borderColor: [
                     "rgba(255, 159, 64, 1)",
                   ],
                   borderWidth: 1,
                 },
               ],
             },
             options: {
               responsive: true,
               maintainAspectRatio: false,
               scales: {
                 y: {
                   beginAtZero: true,
                 },
               },
             },
           });
         },
         error: function (error) {
           console.log(error);
         }
       })
     });

    </script>
  </body>
</html>
